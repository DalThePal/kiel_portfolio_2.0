import React, { useState, useEffect, useContext } from "react"
import styled, { css } from "styled-components"
import { fresponsive } from "utils/fullyResponsive"
import Icon from 'images/menu.svg'
import gsap from 'gsap'
import colors from 'styles/colors'
import MenuLink from "./MenuLink"
import { LogoContext } from 'components/Providers'

const Header = () => {
  const logoColor = useContext(LogoContext).color
  const [open, setOpen] = useState(false)
  const [menuEl, setMenuEl] = useState(null)
  const [timeline, setTimeline] = useState(null)

  useEffect(() => {
    if (menuEl) {
      const tl = gsap.timeline({
        paused: true
      })

      tl.to(menuEl, {
        height: window.innerHeight,
        ease: 'power4.inOut'
      })

      setTimeline(tl)
    }
  }, [menuEl])

  useEffect(() => {
    if (timeline) {
      if (open) {
        timeline.play()
      } else {
        timeline.reverse()
      }
    }
  }, [open, timeline])

  return (
    <Wrapper>
      <Image viewBox="0 0 208 47" fill="none">
        <rect x="4" y="4.15039" width="39" height="40" fill={logoColor}/>
        <path fill-rule="evenodd" clip-rule="evenodd" d="M0 0.150391L46.6991 0.150393L46.6991 46.8495L-2.59816e-06 46.8495L0 0.150391ZM19.8964 8.20763L15.539 8.20763L6.24847 8.20763L6.24847 15.8538L6.24847 23.4999L6.24847 38.7922L15.539 38.7922L19.8964 38.7922L19.8964 31.1461L19.8964 23.4999L19.8964 21.4736C23.8759 21.6457 27.0493 24.9264 27.0493 28.9482L27.0493 38.7922L40.204 38.7923L40.204 26.1309C40.204 23.4065 37.9954 21.1979 35.271 21.1979L27.0493 21.1979L19.8964 21.1979L19.8964 19.8381L20.2514 19.8381L33.4052 19.8381L33.4052 19.5054L33.4052 10.8744C33.4052 9.40062 32.2105 8.20588 30.7367 8.20588L25.5885 8.20588L25.5885 14.1684C25.5885 17.1159 23.199 19.5054 20.2514 19.5054L19.8964 19.5054L19.8964 8.20763Z" fill="#DF582E"/>
        <path d="M66.6147 5.15445H61.1176L59.1429 20.2583H59.0361V5.15445H53.6991V42.5137H59.0361V25.3285H59.1429L61.1176 42.5137H66.6147L63.626 22.3397V22.233L66.6147 5.15445Z" fill={logoColor}/>
        <path d="M72.483 5.15445H67.1459V42.5137H72.483V5.15445Z" fill={logoColor}/>
        <path d="M81.0285 5.15445H73.5566V42.5137H81.2953V37.7104H78.8937V25.7554H80.7616V20.9521H78.8937V9.95779H81.0285V5.15445Z" fill={logoColor}/>
        <path d="M82.1042 5.15445V42.5137H89.6828V37.7104H87.4413V5.15445H82.1042Z" fill={logoColor}/>
        <path d="M101.695 10.4381V19.2976H107.032V10.705C107.032 8.81922 106.48 7.37822 105.377 6.38197C104.31 5.35014 102.922 4.83423 101.215 4.83423C99.5067 4.83423 98.0835 5.35014 96.945 6.38197C95.842 7.4138 95.2905 8.8548 95.2905 10.705V36.9632C95.2905 38.849 95.842 40.3078 96.945 41.3396C98.0479 42.3358 99.4534 42.834 101.161 42.834C102.869 42.834 104.274 42.3358 105.377 41.3396C106.48 40.3078 107.032 38.849 107.032 36.9632V26.7161H101.695V37.2301C101.695 37.5147 101.659 37.7282 101.588 37.8705C101.517 37.9772 101.375 38.0306 101.161 38.0306C100.983 38.0306 100.841 37.9772 100.734 37.8705C100.663 37.7282 100.628 37.5147 100.628 37.2301V10.4381C100.628 10.1535 100.663 9.95779 100.734 9.85105C100.841 9.70872 100.983 9.63756 101.161 9.63756C101.375 9.63756 101.517 9.70872 101.588 9.85105C101.659 9.95779 101.695 10.1535 101.695 10.4381Z" fill={logoColor}/>
        <path d="M119.853 5.15445H114.516V37.2301C114.516 37.5147 114.481 37.7282 114.41 37.8705C114.338 37.9772 114.196 38.0306 113.983 38.0306C113.805 38.0306 113.662 37.9772 113.556 37.8705C113.485 37.7282 113.449 37.5147 113.449 37.2301V5.15445H108.112V36.9632C108.112 38.849 108.663 40.3078 109.766 41.3396C110.869 42.3358 112.275 42.834 113.983 42.834C115.69 42.834 117.096 42.3358 118.199 41.3396C119.302 40.3078 119.853 38.849 119.853 36.9632V5.15445Z" fill={logoColor}/>
        <path d="M140.147 5.15445H131.447L130.86 26.4492L130.647 32.3734H130.54L130.273 26.4492L129.633 5.15445H120.933V42.5137H126.003L125.683 18.4971L125.737 12.0926H125.843L126.27 18.4971L128.192 42.5137H132.942L134.81 18.4971L135.237 12.0926H135.343L135.397 18.4971L135.076 42.5137H140.147V5.15445Z" fill={logoColor}/>
        <path d="M160.473 5.15445H151.774L151.187 26.4492L150.973 32.3734H150.867L150.6 26.4492L149.959 5.15445H141.26V42.5137H146.33L146.01 18.4971L146.063 12.0926H146.17L146.597 18.4971L148.518 42.5137H153.268L155.136 18.4971L155.563 12.0926H155.67L155.723 18.4971L155.403 42.5137H160.473V5.15445Z" fill={logoColor}/>
        <path d="M166.924 5.15445H161.587V42.5137H166.924V5.15445Z" fill={logoColor}/>
        <path d="M182.407 5.15445H177.337L177.604 21.9661L178.458 33.9745H178.351L174.669 5.15445H167.997V42.5137H173.067L172.801 25.7021L171.947 13.6937H172.053L175.736 42.5137H182.407V5.15445Z" fill={logoColor}/>
        <path d="M189.4 22.8201V27.6234H189.933V37.4435C189.933 37.7282 189.898 37.9417 189.827 38.084C189.755 38.1907 189.613 38.2441 189.4 38.2441C189.222 38.2441 189.079 38.1907 188.973 38.084C188.901 37.9417 188.866 37.7282 188.866 37.4435V10.4381C188.866 10.1535 188.901 9.95779 188.973 9.85105C189.079 9.70872 189.222 9.63756 189.4 9.63756C189.613 9.63756 189.755 9.70872 189.827 9.85105C189.898 9.95779 189.933 10.1535 189.933 10.4381V19.2976H195.27V10.705C195.27 8.81922 194.719 7.37822 193.616 6.38197C192.548 5.35014 191.161 4.83423 189.453 4.83423C187.745 4.83423 186.322 5.35014 185.183 6.38197C184.08 7.4138 183.529 8.8548 183.529 10.705V36.9632C183.529 38.849 183.849 40.3078 184.49 41.3396C185.13 42.3358 185.948 42.834 186.945 42.834C187.585 42.834 188.154 42.6205 188.652 42.1935C189.151 41.7665 189.542 41.1617 189.827 40.3789H189.933V42.5137H195.27V22.8201H189.4Z" fill={logoColor}/>
        <path d="M207.985 31.0391C207.985 29.3312 207.611 27.7301 206.864 26.2358C206.117 24.7058 205.316 23.247 204.463 21.8594C203.715 20.6497 203.039 19.4933 202.434 18.3903C201.865 17.2517 201.581 16.1132 201.581 14.9746V10.4381C201.581 10.1535 201.616 9.95779 201.687 9.85105C201.794 9.70872 201.936 9.63756 202.114 9.63756C202.292 9.63756 202.417 9.70872 202.488 9.85105C202.595 9.95779 202.648 10.1535 202.648 10.4381V16.6291H207.985V10.705C207.985 8.81922 207.433 7.37822 206.33 6.38197C205.263 5.35014 203.875 4.83423 202.168 4.83423C200.46 4.83423 199.037 5.35014 197.898 6.38197C196.795 7.4138 196.243 8.8548 196.243 10.705V14.9746C196.243 16.718 196.617 18.3369 197.364 19.8313C198.111 21.3257 198.912 22.7667 199.766 24.1543C200.513 25.364 201.171 26.5382 201.741 27.6768C202.346 28.8153 202.648 29.9361 202.648 31.0391V37.2301C202.648 37.5147 202.595 37.7282 202.488 37.8705C202.417 37.9772 202.292 38.0306 202.114 38.0306C201.936 38.0306 201.794 37.9772 201.687 37.8705C201.616 37.7282 201.581 37.5147 201.581 37.2301V29.3846H196.243V36.9632C196.243 38.849 196.795 40.3078 197.898 41.3396C199.001 42.3358 200.406 42.834 202.114 42.834C203.822 42.834 205.228 42.3358 206.33 41.3396C207.433 40.3078 207.985 38.849 207.985 36.9632V31.0391Z" fill={logoColor}/>
      </Image>
      <MenuIcon src={Icon} alt="menu" onClick={() => setOpen(val => !val)}/>
      <Menu ref={ref => setMenuEl(ref)}>
        <MenuInner>
          <Links>
            <MenuLink>AntiSocial Agency</MenuLink>
            <MenuLink>Adobe Consonant</MenuLink>
            <MenuLink>Jasper.ai</MenuLink>
            <MenuLink to="/case-studies/dallen-hoyal">Dallen Hoyal</MenuLink>
            <MenuLink>Lemond Cycles</MenuLink>
            <MenuLink>Source 7</MenuLink>
          </Links>
        </MenuInner>
      </Menu>
    </Wrapper>
  )
}

export default Header

const Wrapper = styled.header`
  display: flex;
  align-items: center;
  justify-content: center;
  position: fixed;
  z-index: 9;
  top: 0;
  left: 0;
  width: 100%;

  ${fresponsive(css`
    height: 140px;
    gap: 7px;
  `)}
`

const Image = styled.svg`
  position: relative;
  z-index: 2;
  height: auto;

  ${fresponsive(css`
    width: 208px;
  `)}
`

const MenuIcon = styled.img`
  position: absolute;
  z-index: 2;
  cursor: pointer;
  transition: transform 0.5s;

  &:hover {
    transform: rotate(180deg);
  }

  ${fresponsive(css`
    height: 40px;
    width: 40px;
    top: 49px;
    right: 101px;
  `)}
`

const Menu = styled.div`
  position: absolute;
  overflow: hidden;
  z-index: 1;
  width: 100vw;
  height: 0vh;
  top: 0;
  left: 0;
  background-color: ${colors.purple};
`

const MenuInner = styled.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
`

const Links = styled.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  position: absolute;
  width: 100%;
  top: 55%;
  left: 50%;
  transform: translate(-50%, -50%);
`